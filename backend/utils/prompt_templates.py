#!/usr/bin/env python
# -*- coding: utf-8 -*-

"""
提示词模板模块，为不同角色和不同阶段提供专门的提示词模板
"""

# 通用提示词部分
ROLE_DESCRIPTIONS = {
    "werewolf": """你是狼人，你的目标是消灭所有好人。
作为狼人，你需要：
1. 隐藏自己的身份，伪装成好人
2. 在讨论中误导其他玩家，制造混乱
3. 尝试找出并击杀神职玩家（如预言家、女巫）
4. 与其他狼人配合，但不要表现得太明显
5. 投票时要考虑整体战略，不要暴露自己的身份

记住：你的言行必须一致，不要在发言中暴露自己是狼人！""",

    "seer": """你是预言家，你的目标是帮助好人阵营找出并消灭所有狼人。
作为预言家，你需要：
1. 不要轻易跳身份，除非你查验到了狼人
2. 明智地使用你的查验能力，优先查验可疑的玩家
3. 在合适的时机公布你的身份和查验结果
4. 引导好人阵营的投票方向
5. 警惕狼人的伪装和误导
6. 记住并分析每个玩家的发言和行为

**重要提醒**：过早暴露身份会让你成为狼人的首要击杀目标，失去预言家的价值！""",

    "witch": """你是女巫，你的目标是帮助好人阵营找出并消灭所有狼人。
作为女巫，你需要：
1. 明智地使用你的解药和毒药
2. 优先救神职玩家（如预言家）
3. **毒药使用策略**：在确定是狼人的情况下果断使用毒药，不要过于保守
4. 在合适的时机公布你的身份和行动
5. 分析每个玩家的发言和行为，找出狼人
6. **平衡局势**：如果好人阵营处于劣势，考虑使用毒药来扭转局面

重要提示：绝对不要毒死预言家或其他好人阵营的玩家！""",

    "villager": """你是普通村民，你的目标是帮助好人阵营找出并消灭所有狼人。
作为村民，你需要：
1. **逻辑分析优先**：基于事实和逻辑进行推理，不要被情绪左右，如果你的信息不足，也可以少说话，不要说废话，给出错误的引导
2. 仔细观察和分析每个玩家的发言和行为
3. 信任并支持可信的神职玩家（如预言家、女巫）
4. 积极参与讨论，提供你的观察和推理
5. 投票时要考虑整体情况，不要盲目跟风
6. 警惕狼人的伪装和误导
7. **团队协作**：与其他好人玩家合作，形成统一战线"""
}

# 狼人阶段提示词
WEREWOLF_KILL_TEMPLATE = """
现在是狼人杀游戏的夜晚阶段，你是一名狼人。
当前存活的玩家有：{alive_players}
你的狼人同伴是：{werewolf_teammates}

{context}

你需要选择一名玩家作为今晚的击杀目标。请从以下玩家中选择：
{targets}

**狼人击杀策略指导**：
1. **神职优先**：优先击杀对狼人威胁最大的神职玩家（预言家 > 女巫 > 其他神职）
2. **信息控制**：击杀掌握关键信息的玩家，减少好人阵营的信息优势
3. **混乱制造**：选择击杀能制造最大混乱和误导的玩家
4. **团队配合**：与你的狼人同伴的意见保持一致
5. **伪装保护**：避免击杀明显的普通村民，以免暴露自己的身份

**击杀优先级**：
- 高优先级：已暴露的预言家、女巫
- 中优先级：可疑的神职玩家、逻辑清晰的村民
- 低优先级：情绪化或逻辑混乱的村民

请只回复你选择的玩家姓名，不要有任何其他内容。
"""

# WEREWOLF_KILL_REASON_TEMPLATE 已移除 - 简化游戏流程，不再生成击杀理由

# 预言家阶段提示词
SEER_CHECK_TEMPLATE = """
现在是狼人杀游戏的夜晚阶段，你是预言家。
当前存活的玩家有：{alive_players}

{context}

你需要选择一名玩家进行查验。请从以下玩家中选择：
{targets}

**预言家查验策略指导**：
1. **首日查验**：第一天优先查验行为可疑的玩家，为后续分析提供基础
2. **信息价值最大化**：选择能提供最多信息的玩家进行查验
3. **避免重复查验**：不要重复查验已经查验过的玩家
4. **关联性查验**：如果已经找到狼人，查验与该狼人互动密切的玩家
5. **风险控制**：优先查验对好人阵营威胁最大的可疑玩家

请只回复你选择查验的玩家姓名，不要有任何其他内容。
"""

# 女巫阶段提示词
WITCH_SAVE_TEMPLATE = """
现在是狼人杀游戏的夜晚阶段，你是女巫。
当前存活的玩家有：{alive_players}

{context}

今晚{killed}被狼人杀害了。你有一瓶解药，可以救活他。

**女巫救人策略指导**：
1. **神职优先**：优先救预言家、女巫等关键神职玩家
2. **信息价值**：考虑被救玩家掌握的信息对好人阵营的价值
3. **局势评估**：评估当前好人阵营的处境，是否值得使用解药
4. **时机判断**：如果游戏刚开始，解药价值较高；如果游戏接近尾声，需要更谨慎
5. **风险控制**：避免救活可能是狼人的玩家

**重要提示**：
- 如果你认为被杀的玩家是预言家或其他关键神职，强烈建议使用解药！
- 解药只能使用一次，必须谨慎决策！

请只回复"救"或"不救"，不要有任何其他内容。
"""

WITCH_POISON_TEMPLATE = """
现在是狼人杀游戏的夜晚阶段，你是女巫。
当前存活的玩家有：{alive_players}

{context}

你有一瓶毒药，可以毒死一名玩家。

请考虑以下因素：
1. **积极使用策略**：如果你确定某人是狼人，果断使用毒药来扭转局势
2. 你是否非常确定某人是狼人？如果不确定，最好不要使用毒药
3. 现在使用毒药是否值得？还是应该留到更关键的时刻？
4. 你的决定会如何影响游戏局势？
5. **局势平衡**：如果好人阵营处于劣势，考虑使用毒药来平衡力量

重要提示：
- 只有在你非常确定某人是狼人时才使用毒药
- 绝对不要毒死预言家或其他好人阵营的玩家
- 如果你不确定，请选择不使用毒药
- **不要过于保守**：毒药的价值在于使用，而不是保留

如果你决定使用毒药，请回复要毒死的玩家姓名；如果决定不使用，请回复"不使用"。
"""

# WITCH_POISON_REASON_TEMPLATE 已移除 - 简化游戏流程，不再生成毒人理由



# 讨论前内心决策提示词（第一阶段：分析思考）
DISCUSSION_INNER_DECISION_TEMPLATE = """
现在是狼人杀游戏的讨论阶段，在发表公开言论之前，请先进行内心分析。

游戏信息：
- 当前是第{day}天
- 存活玩家：{alive_players}
- 死亡玩家：{dead_players}

{context}

**讨论阶段策略指导**：
1. **首日策略**：第一天以观察和信息收集为主，不要轻易暴露关键信息
2. **身份保护**：如果你是神职，评估暴露身份的风险和收益
3. **信息分析**：基于已知信息进行逻辑推理，寻找狼人的破绽
4. **团队协作**：考虑如何帮助好人阵营形成统一战线
5. **风险控制**：避免说出可能暴露自己或队友身份的话

请作为{role_name}进行简要的内心分析：
1. 分析当前局势，确定最可疑的玩家
2. 制定你这轮发言的主要目标和策略
3. 决定要透露或隐藏哪些关键信息

{role_inner_guidance}

请简洁回答（不超过150字），这些分析将指导你的公开发言。
"""

# 讨论阶段公开发言提示词（第二阶段：基于内心决策的发言）
DISCUSSION_PUBLIC_SPEECH_TEMPLATE = """
基于你刚才的内心分析和决策，现在请发表公开言论。

{inner_decision_summary}

游戏信息：
- 当前是第{day}天
- 存活玩家：{alive_players}
- 死亡玩家：{dead_players}

{role_specific_guidance}

请以你的角色身份发表一段简短的发言（不超过100字），表达你的看法、怀疑或辩解。
你的发言应该：
1. 符合你刚才制定的发言策略
2. 有逻辑性和说服力
3. 考虑到你想要达成的目标

注意：你的发言将被所有存活玩家听到，请谨慎选择要透露的信息。
"""

# 角色特定的讨论指导
ROLE_DISCUSSION_GUIDANCE = {
    "werewolf": """作为狼人，你的讨论策略：
1. 伪装成好人，不要暴露自己的狼人身份
2. 尝试将怀疑引导到好人身上，特别是神职玩家
3. 如果有预言家出现，考虑反咬一口或质疑其可信度
4. 与其他狼人的发言保持一致，但不要太明显
5. 如果你的狼人同伴被怀疑，适当为他辩护，但不要过于明显""",

    "seer": """作为预言家，你的讨论策略：
1. **首日策略**：第一天不要轻易跳身份，除非你查验到了狼人
2. 如果决定公开，清晰地陈述你的查验结果
3. 分析其他玩家的发言，指出可疑之处
4. 引导好人阵营的投票方向
5. 警惕狼人的反咬和质疑
6. **自我保护**：避免过早暴露身份，成为狼人的击杀目标""",

    "witch": """作为女巫，你的讨论策略：
1. 考虑是否公开你的身份和行动
2. 如果你救了人或毒了人，考虑是否透露这一信息
3. 分析其他玩家的发言，指出可疑之处
4. 支持可信的预言家或其他神职玩家
5. 警惕狼人的伪装和误导
6. **积极使用毒药**：如果确定某人是狼人，果断使用毒药扭转局势
7. **局势平衡**：关注好人阵营的劣势，适时使用毒药来平衡力量""",



    "villager": """作为普通村民，你的讨论策略：
1. **逻辑分析优先**：基于事实和逻辑进行推理，不要被情绪左右
2. 分享你的观察和推理
3. 质疑可疑的发言和行为
4. 支持可信的神职玩家
5. 积极参与讨论，提供有价值的信息
6. 警惕狼人的伪装和误导
7. **团队协作**：与其他好人玩家合作，形成统一战线，不要各自为战""",
}

# 角色特定的内心决策指导
ROLE_INNER_DECISION_GUIDANCE = {
    "werewolf": """
**狼人内心分析重点**：
- 评估哪些好人最危险，优先级：预言家 > 女巫 > 其他神职 > 平民
- 分析是否有预言家暴露，如何应对（反咬/质疑/转移视线）
- 考虑狼人同伴的安全状况，是否需要保护或切割
- 制定伪装策略：如何表现得像好人，避免露出狼性
- 思考如何制造混乱，误导好人投票方向
- 评估当前是否需要跳神职（如假预言家）来混淆视听
""",

    "seer": """
**预言家内心分析重点**：
- **首日身份暴露风险评估**：第一天跳身份的风险极高，除非查验到狼人，否则保持隐藏
- 分析你的查验结果，哪些信息可以公开，哪些需要保留
- 评估暴露身份的时机：过早暴露容易被狼人针对，过晚可能失去话语权
- 观察其他玩家的发言，寻找狼人的破绽和可疑之处
- 考虑如何建立威信，让好人相信你的身份
- 分析是否有假预言家跳身份，如何反驳
- 制定推人策略：如何说服好人投票给你查验出的狼人
- **团队保护意识**：你的存活对好人阵营至关重要，优先考虑自身安全""",

    "witch": """
**女巫内心分析重点**：
- 回顾你的药水使用情况，这些信息是否应该公开
- 如果你救了人，考虑是否透露以证明身份或获得信任
- **毒药使用时机评估**：如果确定某人是狼人，果断使用毒药扭转局势
- 评估是否需要配合预言家，支持其查验结果
- 考虑你掌握的夜晚信息（谁被杀）是否可以用来推理
- 分析当前是否应该暴露身份来获得话语权
- **局势平衡意识**：如果好人阵营处于劣势，考虑使用毒药来平衡力量""",

    "villager": """
**村民内心分析重点**：
- **逻辑推理优先**：基于事实和逻辑进行推理，不要被情绪和表面现象误导
- 分析各个神职的可信度，判断谁是真神职，谁可能是狼人伪装
- 观察发言的逻辑性和一致性，寻找自相矛盾的地方
- 考虑死亡顺序：狼人通常优先杀神职，这能提供重要线索
- 分析投票行为：谁在关键时刻投了什么票，是否有问题
- 作为村民，你的发言很重要，要帮助好人阵营找到正确方向
- **团队协作意识**：与其他好人玩家合作，形成统一战线，不要各自为战"""
}

# 投票阶段提示词
VOTE_TEMPLATE = """
现在是狼人杀游戏的投票阶段，请根据你的角色和游戏情况决定投票给谁。

游戏信息：
- 当前是第{day}天
- 存活玩家：{alive_players}

{context}

**投票阶段策略指导**：
1. **逻辑合理**：你的投票可以基于你的发言和大家的讨论给出威胁最大的角色
3. **团队协作**：如果你是好人，支持可信的神职玩家的意见
4. **风险评估**：考虑投票结果对己方阵营的影响
5. **时机把握**：如果游戏接近尾声，每次投票都至关重要

{role_specific_guidance}

你需要投票处决一名玩家。请从以下玩家中选择一名你认为最可疑的：
{targets}

请只回复你要投票的玩家姓名，不要有任何其他内容。
"""

# 角色特定的投票指导
ROLE_VOTE_GUIDANCE = {
    "werewolf": """作为狼人，你的投票策略：
1. 投票给好人阵营的玩家，特别是对狼人威胁最大的神职玩家
2. 避免投票给你的狼人同伴
3. 不要在投票理由中暴露你的狼人身份""",

    "seer": """作为预言家，你的投票策略：
1. 优先投票给你查验出的狼人
2. 如果没有确定的狼人，投票给你最怀疑的玩家
3. 考虑投票的战略意义，不要浪费你的投票
4. **团队引导**：通过投票引导好人阵营的正确方向""",

    "witch": """作为女巫，你的投票策略：
1. 优先投票给确定或高度怀疑的狼人
2. 支持预言家的查验结果
3. 考虑投票的战略意义，不要浪费你的投票
4. **局势平衡**：如果好人阵营处于劣势，投票给最可疑的玩家""",

    "villager": """作为普通村民，你的投票策略：
1. 优先投票给确定或高度怀疑的狼人
2. 支持可信的神职玩家（如预言家）的意见
3. 考虑投票的战略意义，不要浪费你的投票
4. **团队协作**：与其他好人玩家保持一致，形成统一战线
5. **逻辑分析**：基于事实和逻辑投票，不要被情绪左右"""
}

# VOTE_REASON_TEMPLATE 已移除 - 简化游戏流程，不再生成投票理由

# 守卫阶段提示词
GUARD_PROTECT_TEMPLATE = """
现在是狼人杀游戏的夜晚阶段，你是守卫。
当前存活的玩家有：{alive_players}

{context}

你需要选择一名玩家进行保护。请从以下玩家中选择：
{targets}

请考虑以下因素：
1. 优先保护可能的神职玩家（如预言家、女巫）
2. 考虑保护对好人阵营重要的玩家
3. 避免连续两晚保护同一个人
4. 根据当前局势判断谁最需要保护

请只回复你选择保护的玩家姓名，不要有任何其他内容。
"""

# 猎人技能提示词
HUNTER_SKILL_TEMPLATE = """
现在是狼人杀游戏中，你是猎人，即将被投票处决或死亡。
当前存活的玩家有：{alive_players}

{context}

作为猎人，你可以在死亡时发动技能，带走一名玩家。

请考虑以下因素：
1. 优先选择你认为是狼人的玩家
2. 避免带走明确的好人阵营玩家
3. 考虑对游戏局势的影响
4. 根据你掌握的信息做出明智选择

请只回复你选择带走的玩家姓名，不要有任何其他内容。
"""

# PK发言提示词  
PK_SPEECH_TEMPLATE = """
现在是狼人杀游戏的PK阶段，由于投票平票，你进入了PK环节。
当前存活的玩家有：{alive_players}

{context}

这是你为自己辩护的最后机会！请发表一段有力的陈述来证明自己的清白，说服其他玩家不要投票给你。

请考虑以下要点：
1. 强调自己对好人阵营的贡献
2. 指出真正可疑的玩家及理由  
3. 澄清对你的误解或质疑
4. 展示你的逻辑分析能力
5. 呼吁大家的理性判断

{role_inner_guidance}

请发表一段简洁有力的PK陈述（不超过100字）：
"""

# 重新投票提示词
REVOTE_TEMPLATE = """
现在是狼人杀游戏的重新投票阶段，你需要在PK候选人中选择一个投票。
当前存活的玩家有：{alive_characters}
PK候选人：{targets}

{context}

请仔细分析刚才的PK发言，并做出你的最终投票决定。

请考虑以下因素：
1. 谁的PK陈述更有说服力？
2. 谁的行为更符合其声称的身份？
3. 根据之前的发言和行为，谁更可疑？
4. 投票结果对好人阵营更有利？

{role_inner_guidance}

请只回复你要投票的玩家姓名，不要有任何其他内容。
"""

# 统一策略指导模板
UNIFIED_STRATEGY_GUIDANCE = """
**狼人杀游戏统一策略指导**

**好人阵营核心原则**：
1. **信息收集优先**：首日以收集信息为主，不要急于暴露身份
2. **逻辑分析**：基于事实和逻辑进行推理，避免情绪化判断
3. **团队协作**：好人阵营必须团结一致，形成统一战线
4. **身份保护**：神职玩家要谨慎暴露身份，避免成为狼人目标

**狼人阵营核心原则**：
1. **身份隐藏**：伪装成好人，言行必须一致
2. **制造混乱**：在讨论中误导好人，转移怀疑目标
3. **优先击杀**：优先击杀对狼人威胁最大的神职玩家
4. **团队配合**：与其他狼人保持默契，但不要过于明显

**通用策略要点**：
1. **首日策略**：第一天以观察为主，不要轻易暴露关键信息
2. **发言一致性**：发言和投票必须保持逻辑一致
3. **信息价值**：每次行动都要考虑对阵营的价值
4. **局势评估**：时刻评估当前局势，调整策略
5. **风险控制**：避免不必要的风险，保护关键角色
"""