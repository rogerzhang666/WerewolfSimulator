# 狼人杀模拟器 🐺

## 项目介绍

一个AI驱动的狼人杀游戏模拟器，8个AI角色自动进行完整的狼人杀游戏。用户可以观察游戏进程，并通过强大的记忆调试功能深入了解每个AI角色的思考过程和决策逻辑。

## ✨ 主要特性

### 🎮 完整的游戏机制
- **8人标准局**：2狼人 + 1预言家 + 1女巫 + 4平民
- **完整夜晚阶段**：狼人击杀、预言家查验、女巫救人/毒人
- **白天阶段**：自由讨论、民主投票
- **胜负判定**：狼人屠边或好人出局狼人

### 🧠 智能AI系统
- **双重策略系统**：AI角色先进行内心分析，再发表策略性言论
- **多维度记忆**：观察、决策、发言、信念、内心想法五重记忆体系
- **角色差异化**：8种不同性格，每个角色有独特的行为模式
- **严格信息隔离**：确保角色只知道应该知道的信息
- **智能推理**：基于身份特点和记忆信息的策略决策

### 🔧 记忆调试系统
- **记忆查看器**：点击角色发言旁的"记忆"按钮查看AI思考过程
- **内心想法透视**：查看夜晚行动理由、投票理由、发言前分析
- **完整记忆追踪**：观察记录、决策历史、信念变化一目了然

## 🎯 游戏特色

### 双重策略系统
- **内心分析**：AI角色先分析局势、制定策略、评估风险
- **策略发言**：基于内心分析发表符合身份的言论
- **信息隔离**：夜晚行动理由和投票理由都是内心想法，不公开

### 角色配置
- **8个AI角色**：张三、李四、王五、赵六、钱七、孙八、周九、吴十
- **多样性格**：激进、保守、理性、情绪化、冷静、多疑、沉默、活跃
- **身份随机**：每局游戏随机分配狼人、预言家、女巫、平民身份

## 💻 技术架构

### 核心组件
- **前端界面**：HTML/CSS/JS + WebSocket实时通信 + 记忆调试器
- **游戏引擎**：Python Flask + Socket.IO + 多线程游戏循环
- **记忆系统**：五维记忆架构 + 智能上下文构建 + AI调用追踪
- **AI接口**：多模型支持（DeepSeek R1/V3、Qwen Plus/Turbo、豆包系列）

### 技术特色
- **五维记忆架构**：观察、决策、发言、信念、内心想法的完整记忆体系
- **双重策略系统**：内心分析阶段 + 策略发言阶段的分离设计
- **严格信息隔离**：基于角色身份的动态信息过滤机制
- **实时调试功能**：可视化AI思考过程的记忆查看器
- **模块化设计**：清晰的分层架构，便于维护和扩展
- **异步处理**：多线程AI调用，不阻塞游戏流程

### 性能指标
- **AI响应时间**：< 5秒
- **游戏流程延迟**：< 1秒  
- **内存使用**：< 512MB
- **并发支持**：10个游戏实例
- **系统稳定性**：99%+正常运行时间

## 🎮 使用指南

### 基本操作
- **开始游戏**：点击"开始游戏"按钮，AI角色自动开始狼人杀对局
- **观察进程**：游戏自动进行，可观看实时游戏日志和角色行为
- **控制游戏**：使用暂停/恢复/重置按钮控制游戏流程
- **角色状态**：查看存活角色列表和基本信息（不显示真实身份）

### 记忆调试功能 🔍
这是项目的核心特色功能，让你能够"透视"AI的内心世界：

- **查看AI思考**：点击角色发言旁的紫色"记忆"按钮
- **内心想法透视**：查看夜晚行动理由、投票理由、发言前深度分析
- **五维记忆查看**：
  - 📝 **观察记录**：AI看到的游戏事件
  - 🎯 **决策历史**：每次行动的选择和理由
  - 💬 **发言记录**：公开发言的策略意图
  - 🤔 **信念记录**：对其他角色的推测和信任度
  - 💭 **内心想法**：私密的分析过程和真实想法
- **AI调用记录**：查看完整的模型调用历史和提示词
- **实时更新**：记忆状态随游戏进程自动刷新

### 高级功能
- **模型调用监控**：右侧面板显示实时的AI模型调用状态
- **游戏日志过滤**：查看不同阶段和角色的行为记录
- **性能监控**：观察AI响应时间和系统性能指标

## 🚀 快速开始

### 1. 安装依赖
```bash
git clone https://github.com/rogerzhang666/WerewolfSimulator.git
cd WerewolfSimulator
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate
pip install -r requirements.txt
```

### 2. 配置API密钥
创建 `.env` 文件，添加你的AI模型API密钥：
```env
# DeepSeek API配置
DEEPSEEK_API_KEY=your_deepseek_api_key_here

# 阿里百炼平台配置（可选）
QWEN_API_KEY=your_qwen_api_key_here

# 火山方舟平台配置（可选）
DOUBAO_API_KEY=your_doubao_api_key_here

# 服务器配置
PORT=5003
DEBUG=True

# 游戏配置（可选）
DEFAULT_AI_MODEL=deepseek-r1
GAME_SPEED=normal
```

> **注意**: 项目支持多种AI模型，至少需要配置一种API密钥。推荐使用DeepSeek API，性价比最高。

### 3. 启动游戏
```bash
python run.py
```

访问 `http://localhost:5003` 开始体验！

### 🎮 游戏操作
- **开始游戏**：点击按钮，AI角色自动开始狼人杀
- **观察游戏**：查看实时游戏日志和角色行为
- **调试记忆**：点击发言旁的"记忆"按钮查看AI思考过程
- **控制游戏**：使用暂停/恢复/重置按钮

## 🎯 项目完成度

### ✅ 核心功能（已完成）

#### 游戏机制 (100%)
- [x] **8人标准局**：2狼人 + 1预言家 + 1女巫 + 4平民
- [x] **完整夜晚阶段**：狼人击杀、预言家查验、女巫救人毒人
- [x] **白天讨论投票**：自由发言、民主投票、策略推理
- [x] **胜负判定系统**：狼人屠边 vs 好人出局狼人
- [x] **多线程游戏引擎**：流畅的游戏循环，支持暂停恢复

#### AI智能系统 (95%)
- [x] **五维记忆架构**：观察、决策、发言、信念、内心想法完整实现
- [x] **双重策略系统**：内心分析 + 策略发言的分离机制
- [x] **多AI模型支持**：DeepSeek R1/V3、Qwen系列、豆包系列
- [x] **角色差异化配置**：8种不同性格和行为模式
- [x] **严格信息隔离**：基于身份的动态信息过滤
- [x] **智能决策引擎**：角色身份特定的策略决策

#### 用户界面 (90%)
- [x] **实时WebSocket通信**：毫秒级游戏状态同步
- [x] **记忆调试器**：可视化查看AI完整思考过程
- [x] **游戏控制面板**：开始/暂停/恢复/重置功能
- [x] **实时日志系统**：详细的游戏进程记录
- [x] **AI调用监控**：模型调用状态和性能指标

#### 技术架构 (95%)
- [x] **模块化设计**：清晰的分层架构
- [x] **异步处理机制**：AI调用不阻塞游戏流程
- [x] **错误处理与降级**：稳定的系统运行
- [x] **配置驱动架构**：灵活的参数配置

### 🚧 优化空间

#### 短期优化（1-2周）
- [ ] **游戏平衡性调优**：调整AI决策权重，平衡胜负比例
- [ ] **性能优化**：缓存机制，减少API调用延迟
- [ ] **错误处理增强**：更完善的异常恢复机制

#### 中期扩展（1-2个月）
- [ ] **游戏录像回放**：支持完整游戏过程回放
- [ ] **多局统计分析**：胜负率、角色表现等数据分析
- [ ] **更多角色身份**：猎人、守卫、白痴等扩展角色
- [ ] **用户参与模式**：支持真人与AI混合对局

#### 长期发展（3-6个月）
- [ ] **移动端适配**：响应式设计和移动端优化
- [ ] **AI学习进化**：跨局学习和策略优化
- [ ] **商业化功能**：用户系统、游戏房间、排行榜
- [ ] **多游戏支持**：扩展到其他推理类游戏

## 🤝 贡献与支持

欢迎提交Issue和Pull Request！项目基于MIT许可证开源。

⭐ 如果这个项目对你有帮助，请给个星标支持！
